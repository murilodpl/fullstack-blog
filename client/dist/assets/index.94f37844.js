var S=Object.defineProperty,k=Object.defineProperties;var P=Object.getOwnPropertyDescriptors;var b=Object.getOwnPropertySymbols;var I=Object.prototype.hasOwnProperty,E=Object.prototype.propertyIsEnumerable;var L=(t,i,l)=>i in t?S(t,i,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[i]=l,o=(t,i)=>{for(var l in i||(i={}))I.call(i,l)&&L(t,l,i[l]);if(b)for(var l of b(i))E.call(i,l)&&L(t,l,i[l]);return t},c=(t,i)=>k(t,P(i));import{r as f,j as e,a as u,N as p,b as T,u as w,A as R,m as C,R as F,c as N,d as M,e as j,B as $}from"./vendor.d8cfb2f0.js";const A=function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const m of r.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&n(m)}).observe(document,{childList:!0,subtree:!0});function l(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerpolicy&&(r.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?r.credentials="include":s.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(s){if(s.ep)return;s.ep=!0;const r=l(s);fetch(s.href,r)}};A();function x(t){const[i,l]=f.exports.useState(!1);function n(){l(r=>!r)}function s(){localStorage.removeItem("user")}return e("header",{className:"shadow-md mb-6",children:u("nav",{className:"px-2 sm:px-4 py-2.5 rounded",children:[u("div",{className:"container flex flex-wrap justify-between items-center py-6 mx-auto",children:[e("div",{className:"flex",children:u("h1",{className:"text-md md:text-xl font-bold mr-auto text-primary self-center",children:["Welcome, ",t.user.name,t.user.admin&&" (Admin)","!"]})}),e("div",{className:"md:hidden flex items-center",children:e("button",{className:"outline-none menu-button","aria-label":"Open mobile menu",onClick:n,children:e("svg",{className:"w-6 h-6 text-gray-500","x-show":"! showMenu",fill:"none",viewBox:"0 00 24 24",stroke:"currentColor",children:e("path",{d:"m4 6h16M4 12h16M4 18h16"})})})}),e("div",{className:"hidden w-full md:block md:w-auto",id:"mobile-menu",children:u("ul",{className:"flex flex-col mt-4 md:flex-row md:space-x-8 md:mt-0 md:text-sm",children:[e("li",{children:e(p,{to:"/",className:"navItem",children:"Home"})}),e("li",{children:e(p,{to:"/myposts",className:"navItem",children:"My Posts"})}),e("li",{children:e(p,{to:"/login",className:"navItem",onClick:s,children:"Logout"})})]})})]}),e("div",{className:`${!i&&"hidden"} md:hidden mobile-menu`,children:u("ul",{className:"",children:[e("li",{children:e(p,{to:"/",className:"navItem",onClick:n,children:"Home"})}),e("li",{children:e(p,{to:"/myposts",className:"navItem",onClick:n,children:"My Posts"})}),e("li",{children:e(p,{to:"/login",className:"navItem",onClick:n,children:"Logout"})})]})})]})})}const v=T.create({baseURL:"https://he4rtlabs-challenges-03.herokuapp.com/",validateStatus:!1});function D(t){async function i(l){await v.delete("/posts/delete",{data:{id:l}}).then(n=>{console.log(n)}).catch(n=>{console.log(n)}).finally(()=>{t.setRemovePost(n=>!n)})}return u("div",{className:"border p-4 my-4",children:[u("div",{className:"flex justify-between items-center mb-3",children:[e("h3",{children:t.post.title}),(t.myposts||t.admin)&&e("button",{onClick:()=>i(t.post.id),className:"p-1 text-red-500 border border-red-500 transition-all hover:bg-red-500 hover:text-white",children:"Delete"})]}),e("p",{className:"whitespace-pre-line",children:t.post.content}),e("small",{children:t.post.author})]})}function O(t){const[i,l]=f.exports.useState([]),[n,s]=f.exports.useState(!1);console.log(t.user.admin),f.exports.useEffect(()=>{s(!0);async function m(){await v.get("/posts/getAll").then(g=>{l(g.data)}).catch(g=>{console.log(g)}).finally(()=>{s(!1)})}return m(),()=>s(!1)},[]);const r=i.length!=0?i.map((m,g)=>e(D,{admin:t.user.admin,post:m},g)):e("p",{className:"my-4",children:"Nothing found."});return u("div",{className:"h-full",children:[e(x,{user:t.user}),u("div",{className:"container",children:[e("h2",{className:"pageTitle",children:"Blog"}),n?e("div",{className:"flex justify-center",children:u("div",{className:"lds-roller invert",children:[e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{})]})}):i&&r]})]})}function q(t){const[i,l]=f.exports.useState({email:"",password:"",name:""}),[n,s]=f.exports.useState({email:!1,password:!1,isDuplicate:!1,err:!1,isLoading:!1,success:!1});function r(g){s({email:!1,password:!1,isDuplicate:!1,err:!1,isLoading:!1});let{name:d,value:a}=g.target;l(h=>c(o({},h),{[d]:a}))}function m(g){if(g.preventDefault(),i.email=="")return s(d=>c(o({},d),{email:!0}));if(s(d=>c(o({},d),{email:!1})),i.name=="")return s(d=>c(o({},d),{name:!0}));if(s(d=>c(o({},d),{name:!1})),i.password=="")return s(d=>c(o({},d),{password:!0}));s(d=>c(o({},d),{password:!1})),s(d=>c(o({},d),{isLoading:!0,err:!1})),v.post("/users/register",i).then(d=>{d.data.status===201?(l({email:"",password:"",name:""}),s(a=>c(o({},a),{isLoading:!1,success:!0})),setTimeout(()=>{t.handleTransition()},1e3)):s(a=>c(o({},a),{isLoading:!1,isDuplicate:!0,success:!1}))}).catch(d=>{s(a=>c(o({},a),{isLoading:!1,err:!0,success:!1}))})}return u("div",{className:"registerFrame login",children:[e("h1",{className:"text-white",children:"Sign up"}),u("form",{name:"registerForm",id:"registerForm",children:[e("input",{className:`${(n.email||n.isDuplicate)&&"border-red-500"}`,type:"email",id:"email",name:"email",value:i.email,onChange:r,placeholder:"Enter your email...",required:!0}),e("input",{className:`${(n.name||n.isDuplicate)&&"border-red-500"}`,type:"text",id:"name",name:"name",value:i.name,onChange:r,placeholder:"Enter your name...",required:!0}),e("input",{className:`${(n.password||n.isDuplicate)&&"border-red-500"}`,type:"password",id:"password",name:"password",value:i.password,onChange:r,placeholder:"Enter your password...",required:!0}),n.isDuplicate&&e("p",{className:"text-red-500",children:"E-mail already registered..."}),n.err&&e("p",{className:"text-red-500",children:"There was an error, please try again later."}),n.isLoading&&e("div",{className:"flex justify-center",children:u("div",{className:"lds-roller",children:[e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{})]})}),n.success&&e("p",{className:"text-green-500",children:"Registered successfully!"}),u("div",{className:"btnDiv text-white",children:[u("span",{children:["Already have an account? Click ",e("a",{onClick:t.handleTransition,children:"here"})]}),e("input",{className:"btnRegister",type:"submit",onClick:m,value:"Sign up"})]})]})]})}function B(t){const i=w(),[l,n]=f.exports.useState({email:"",password:""}),[s,r]=f.exports.useState({email:!1,password:!1,wrongLogin:!1,err:!1,isLoading:!1,success:!1});function m(d){r({email:!1,password:!1,wrongLogin:!1,err:!1,isLoading:!1});let{name:a,value:h}=d.target;n(y=>c(o({},y),{[a]:h}))}function g(d){if(d.preventDefault(),l.email=="")return r(a=>c(o({},a),{email:!0}));if(r(a=>c(o({},a),{email:!1})),l.password=="")return r(a=>c(o({},a),{password:!0}));r(a=>c(o({},a),{password:!1})),r(a=>c(o({},a),{isLoading:!0,err:!1})),v.post("/users/login",l).then(a=>{a.data.status===200?(r(h=>c(o({},h),{isLoading:!1,success:!0})),localStorage.setItem("user",JSON.stringify(a.data)),setTimeout(()=>{i("/")},1e3)):r(h=>c(o({},h),{success:!1,isLoading:!1,wrongLogin:!0}))}).catch(a=>{r(h=>c(o({},h),{success:!1,isLoading:!1,err:!0})),console.log(a)})}return u("div",{className:"loginFrame login",children:[e("h1",{children:"Log in"}),u("form",{name:"loginForm",id:"loginForm",children:[e("input",{className:`${(s.email||s.wrongLogin)&&"border-red-500"}`,type:"email",id:"email",name:"email",value:l.email,onChange:m,placeholder:"Enter your email...",required:!0}),e("input",{className:`${(s.password||s.wrongLogin)&&"border-red-500"}`,type:"password",id:"password",name:"password",value:l.password,onChange:m,placeholder:"Enter your password...",required:!0}),s.wrongLogin&&e("p",{className:"text-red-500",children:"Wrong email or password..."}),s.err&&e("p",{className:"text-red-500",children:"There was an error, please try again later."}),s.isLoading&&e("div",{className:"flex justify-center",children:u("div",{className:"lds-roller invert",children:[e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{})]})}),s.success&&e("p",{className:"text-green-500",children:"Successfully logged in!"}),u("div",{className:"btnDiv",children:[u("span",{children:["Don't have an account yet? Click ",e("a",{onClick:t.handleTransition,children:"here"})]}),e("input",{className:"btnLogin",type:"submit",onClick:g,value:"Login"})]})]})]})}function H(){const[t,i]=f.exports.useState(!0),l={login:{backgroundColor:"#f2f2f2",scaleY:1},register:{backgroundColor:"#1a1b1e",scaleY:1}};function n(){i(s=>!s)}return u("div",{className:"h-full w-full relative p-4",children:[e(R,{exitBeforeEnter:!0,children:e(C.div,{className:"home absolute top-0 left-0 -z-10",style:{transformOrigin:"top"},variants:l,initial:{scaleY:0},animate:t?"login":"register",transition:{type:"tween",stiffness:100,duration:.5}},t)}),e(C.div,{className:"home",initial:{opacity:0,delay:1},animate:{opacity:1},exit:{opacity:0},transition:{type:"Inertia",stiffness:100,duration:.75},children:t?e(B,{handleTransition:n}):e(q,{handleTransition:n})},t)]})}function U(t){const[i,l]=f.exports.useState([]),[n,s]=f.exports.useState(!1),[r,m]=f.exports.useState(!1);f.exports.useEffect(()=>{m(!0);async function d(){if(!t.user)return console.log(t);await v.get(`/posts/getAll/${t.user.id}`).then(a=>{l(a.data)}).catch(a=>{console.log(a)}).finally(()=>{m(!1)})}return d(),()=>m(!1)},[n]);const g=i.length!=0?i.map((d,a)=>e(D,{post:d,myposts:!0,setRemovePost:s},a)):e("p",{className:"my-4",children:"Nothing found."});return u("div",{className:"h-full",children:[e(x,{user:t.user}),u("div",{className:"container",children:[u("div",{className:"flex justify-between items-center   pageTitle",children:[e("h2",{children:"My Posts"}),e(p,{to:"/newPost",className:"p-1 text-green-500 border border-green-500 transition-all hover:bg-green-500 hover:text-white",children:"New Post"})]}),r?e("div",{className:"flex justify-center",children:u("div",{className:"lds-roller invert",children:[e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{})]})}):i&&g]})]})}function Y(t){const i=w(),[l,n]=f.exports.useState({title:"",content:"",author:t.user.id}),[s,r]=f.exports.useState({title:!1,content:!1,isDuplicate:!1,err:!1,isLoading:!1,success:!1});function m(d){r({title:!1,content:!1,isDuplicate:!1,err:!1,isLoading:!1});let{name:a,value:h}=d.target;n(y=>c(o({},y),{[a]:h}))}function g(d){if(d.preventDefault(),l.title=="")return r(a=>c(o({},a),{title:!0}));if(r(a=>c(o({},a),{title:!1})),l.content=="")return r(a=>c(o({},a),{content:!0}));r(a=>c(o({},a),{content:!1})),r(a=>c(o({},a),{isLoading:!0,err:!1})),v.post("/posts/register",l).then(a=>{a.data.status===201?(n(h=>c(o({},h),{title:"",content:""})),r(h=>c(o({},h),{isLoading:!1,success:!0})),setTimeout(()=>{i("/myposts")},1e3)):r(h=>c(o({},h),{isLoading:!1,isDuplicate:!0,success:!1}))}).catch(a=>{r(h=>c(o({},h),{isLoading:!1,err:!0,success:!1}))})}return u("div",{className:"h-full",children:[e(x,{user:t.user}),u("div",{className:"container",children:[e("h2",{className:"pageTitle",children:"New Post"}),u("form",{className:"mt-4",name:"registerPost",id:"registerPost",children:[e("label",{htmlFor:"title",children:"Title:"}),e("input",{className:`${(s.title||s.isDuplicate)&&"border-red-500"}`,type:"text",id:"title",name:"title",value:l.title,onChange:m,required:!0}),e("label",{htmlFor:"content",children:"Content:"}),e("textarea",{className:`${(s.content||s.isDuplicate)&&"border-red-500"}`,id:"content",name:"content",value:l.content,onChange:m,required:!0,cols:"30",rows:"10"}),s.isDuplicate&&e("p",{className:"text-red-500",children:"Duplicate title..."}),s.err&&e("p",{className:"text-red-500",children:"There was an error, please try again later."}),s.isLoading&&e("div",{className:"flex justify-center",children:u("div",{className:"lds-roller invert",children:[e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{})]})}),s.success&&e("p",{className:"text-green-500",children:"Registered successfully!"}),e("button",{className:"btnPost",type:"submit",onClick:g,children:"Submit"})]})]})]})}function J(){const t=JSON.parse(localStorage.getItem("user"))||[""],i=w();return f.exports.useEffect(()=>{if(localStorage.getItem("user")==null)return i("/login")},[window.location.href]),e("div",{className:"App",children:u(F,{children:[e(N,{path:"/",element:e(O,{user:t[0]})}),e(N,{path:"/myposts",element:e(U,{user:t[0]})}),e(N,{path:"/newPost",element:e(Y,{user:t[0]})}),e(N,{path:"/login",element:e(H,{})})]})})}M.render(e(j.StrictMode,{children:e($,{children:e(J,{})})}),document.getElementById("root"));
