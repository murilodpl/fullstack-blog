var D=Object.defineProperty,P=Object.defineProperties;var R=Object.getOwnPropertyDescriptors;var L=Object.getOwnPropertySymbols;var M=Object.prototype.hasOwnProperty,I=Object.prototype.propertyIsEnumerable;var C=(a,r,l)=>r in a?D(a,r,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[r]=l,d=(a,r)=>{for(var l in r||(r={}))M.call(r,l)&&C(a,l,r[l]);if(L)for(var l of L(r))I.call(r,l)&&C(a,l,r[l]);return a},u=(a,r)=>P(a,R(r));import{r as f,j as e,a as c,N as p,b as E,u as x,A as F,m as S,R as T,c as N,d as j,e as A,f as $,B as O}from"./vendor.e4c2ae76.js";const q=function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))n(t);new MutationObserver(t=>{for(const i of t)if(i.type==="childList")for(const m of i.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&n(m)}).observe(document,{childList:!0,subtree:!0});function l(t){const i={};return t.integrity&&(i.integrity=t.integrity),t.referrerpolicy&&(i.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?i.credentials="include":t.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(t){if(t.ep)return;t.ep=!0;const i=l(t);fetch(t.href,i)}};q();function w(a){const[r,l]=f.exports.useState(!1);function n(){l(i=>!i)}function t(){localStorage.removeItem("user")}return e("header",{className:"shadow-md mb-6",children:c("nav",{className:"px-2 sm:px-4 py-2.5 rounded",children:[c("div",{className:"container flex flex-wrap justify-between items-center py-6 mx-auto",children:[e("div",{className:"flex",children:c("h1",{className:"text-md md:text-xl font-bold mr-auto text-primary self-center",children:["Welcome, ",a.user.name,a.user.admin&&" (Admin)","!"]})}),e("div",{className:"md:hidden flex items-center",children:e("button",{className:"outline-none menu-button","aria-label":"Open mobile menu",onClick:n,children:e("svg",{className:"w-6 h-6 text-gray-500","x-show":"! showMenu",fill:"none",viewBox:"0 00 24 24",stroke:"currentColor",children:e("path",{d:"m4 6h16M4 12h16M4 18h16"})})})}),e("div",{className:"hidden w-full md:block md:w-auto",id:"mobile-menu",children:c("ul",{className:"flex flex-col mt-4 md:flex-row md:space-x-8 md:mt-0 md:text-sm",children:[e("li",{children:e(p,{to:"/",className:"navItem",children:"Home"})}),e("li",{children:e(p,{to:"/myposts",className:"navItem",children:"My Posts"})}),e("li",{children:e(p,{to:"/login",className:"navItem",onClick:t,children:"Logout"})})]})})]}),e("div",{className:`${!r&&"hidden"} md:hidden mobile-menu`,children:c("ul",{className:"",children:[e("li",{children:e(p,{to:"/",className:"navItem",onClick:n,children:"Home"})}),e("li",{children:e(p,{to:"/myposts",className:"navItem",onClick:n,children:"My Posts"})}),e("li",{children:e(p,{to:"/login",className:"navItem",onClick:n,children:"Logout"})})]})})]})})}function b(){return e("footer",{className:"bg-primary text-white flex justify-center items-center py-8 mt-auto",children:c("p",{className:"my-0",children:["Made with \u{1F49A} by ",e("a",{className:"text-green-300 font-bold transition-all hover:underline",rel:"noopenner",href:"https://github.com/murilodpl",target:"_blank",children:"Murilo"})]})})}const v=E.create({baseURL:"https://murilo-fullstack-blog.herokuapp.com/",validateStatus:!1});function k(a){const[r,l]=f.exports.useState(!0),n=a.post.content;async function t(m){await v.delete("/posts/delete",{data:{id:m}}).then(g=>{console.log(g)}).catch(g=>{console.log(g)}).finally(()=>{a.setRemovePost(g=>!g)})}function i(){l(!r)}return c("div",{className:"border border-gray-300 p-4 my-4",children:[c("div",{className:"flex justify-between items-center mb-3",children:[e("h3",{children:a.post.title}),(a.myposts||a.admin)&&e("button",{onClick:()=>t(a.post.id),className:"p-1 text-red-500 border border-red-500 transition-all hover:bg-red-500 hover:text-white",children:"Delete"})]}),c("p",{className:"whitespace-pre-line",children:[r&&n.length>150?n.slice(0,100):n,n.length>150&&e("span",{onClick:i,className:"cursor-pointer text-blue-500 transition-all hover:text-blue-700",children:r?" Read more":" Show less"})]}),e("small",{children:a.post.name})]})}function B(a){const[r,l]=f.exports.useState([]),[n,t]=f.exports.useState(!1),[i,m]=f.exports.useState(!1);f.exports.useEffect(()=>{t(!0);async function o(){await v.get("/posts/getAll").then(s=>{l(s.data)}).catch(s=>{console.log(s)}).finally(()=>{t(!1)})}return o(),()=>t(!1)},[i]);const g=r.length!=0?r.map((o,s)=>e(k,{admin:a.user.admin,setRemovePost:m,post:o},s)):e("p",{className:"my-4",children:"Nothing found."});return c("div",{className:"page",children:[e(w,{user:a.user}),c("div",{className:"container",children:[e("h2",{className:"pageTitle",children:"Posts"}),n?e("div",{className:"flex justify-center",children:c("div",{className:"lds-roller invert",children:[e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{})]})}):r&&g]}),e(b,{})]})}function H(a){const[r,l]=f.exports.useState({email:"",password:"",name:""}),[n,t]=f.exports.useState({email:!1,password:!1,isDuplicate:!1,err:!1,isLoading:!1,success:!1});function i(g){t({email:!1,password:!1,isDuplicate:!1,err:!1,isLoading:!1});let{name:o,value:s}=g.target;l(h=>u(d({},h),{[o]:s}))}function m(g){if(g.preventDefault(),r.email=="")return t(o=>u(d({},o),{email:!0}));if(t(o=>u(d({},o),{email:!1})),r.name=="")return t(o=>u(d({},o),{name:!0}));if(t(o=>u(d({},o),{name:!1})),r.password=="")return t(o=>u(d({},o),{password:!0}));t(o=>u(d({},o),{password:!1})),t(o=>u(d({},o),{isLoading:!0,err:!1})),v.post("/users/register",r).then(o=>{o.data.status===201?(l({email:"",password:"",name:""}),t(s=>u(d({},s),{isLoading:!1,success:!0})),setTimeout(()=>{a.handleTransition()},1e3)):t(s=>u(d({},s),{isLoading:!1,isDuplicate:!0,success:!1}))}).catch(o=>{t(s=>u(d({},s),{isLoading:!1,err:!0,success:!1}))})}return c("div",{className:"registerFrame login",children:[e("h1",{className:"text-white",children:"Sign up"}),c("form",{name:"registerForm",id:"registerForm",children:[e("input",{className:`${(n.email||n.isDuplicate)&&"border-red-500"}`,type:"email",id:"email",name:"email",value:r.email,onChange:i,placeholder:"Enter your email...",required:!0}),e("input",{className:`${(n.name||n.isDuplicate)&&"border-red-500"}`,type:"text",id:"name",name:"name",value:r.name,onChange:i,placeholder:"Enter your name...",required:!0}),e("input",{className:`${(n.password||n.isDuplicate)&&"border-red-500"}`,type:"password",id:"password",name:"password",value:r.password,onChange:i,placeholder:"Enter your password...",required:!0}),n.isDuplicate&&e("p",{className:"text-red-500",children:"E-mail already registered..."}),n.err&&e("p",{className:"text-red-500",children:"There was an error, please try again later."}),n.isLoading&&e("div",{className:"flex justify-center",children:c("div",{className:"lds-roller",children:[e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{})]})}),n.success&&e("p",{className:"text-green-500",children:"Registered successfully!"}),c("div",{className:"btnDiv text-white",children:[c("span",{children:["Already have an account? Click ",e("a",{onClick:a.handleTransition,children:"here"})]}),e("input",{className:"btnRegister",type:"submit",onClick:m,value:"Sign up"})]})]})]})}function U(a){const r=x(),[l,n]=f.exports.useState({email:"",password:""}),[t,i]=f.exports.useState({email:!1,password:!1,wrongLogin:!1,err:!1,isLoading:!1,success:!1});function m(o){i({email:!1,password:!1,wrongLogin:!1,err:!1,isLoading:!1});let{name:s,value:h}=o.target;n(y=>u(d({},y),{[s]:h}))}function g(o){if(o.preventDefault(),l.email=="")return i(s=>u(d({},s),{email:!0}));if(i(s=>u(d({},s),{email:!1})),l.password=="")return i(s=>u(d({},s),{password:!0}));i(s=>u(d({},s),{password:!1})),i(s=>u(d({},s),{isLoading:!0,err:!1})),v.post("/users/login",l).then(s=>{s.data.status===200?(i(h=>u(d({},h),{isLoading:!1,success:!0})),localStorage.setItem("user",JSON.stringify(s.data)),setTimeout(()=>{r("/")},1e3)):i(h=>u(d({},h),{success:!1,isLoading:!1,wrongLogin:!0}))}).catch(s=>{i(h=>u(d({},h),{success:!1,isLoading:!1,err:!0})),console.log(s)})}return c("div",{className:"loginFrame login",children:[e("h1",{children:"Log in"}),c("form",{name:"loginForm",id:"loginForm",children:[e("input",{className:`${(t.email||t.wrongLogin)&&"border-red-500"}`,type:"email",id:"email",name:"email",value:l.email,onChange:m,placeholder:"Enter your email...",required:!0}),e("input",{className:`${(t.password||t.wrongLogin)&&"border-red-500"}`,type:"password",id:"password",name:"password",value:l.password,onChange:m,placeholder:"Enter your password...",required:!0}),t.wrongLogin&&e("p",{className:"text-red-500",children:"Wrong email or password..."}),t.err&&e("p",{className:"text-red-500",children:"There was an error, please try again later."}),t.isLoading&&e("div",{className:"flex justify-center",children:c("div",{className:"lds-roller invert",children:[e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{})]})}),t.success&&e("p",{className:"text-green-500",children:"Successfully logged in!"}),c("div",{className:"btnDiv",children:[c("span",{children:["Don't have an account yet? Click ",e("a",{onClick:a.handleTransition,children:"here"})]}),e("input",{className:"btnLogin",type:"submit",onClick:g,value:"Login"})]})]})]})}function Y(){const[a,r]=f.exports.useState(!0),l={login:{backgroundColor:"#f2f2f2",scaleY:1},register:{backgroundColor:"#1a1b1e",scaleY:1}};function n(){r(t=>!t)}return c("div",{className:"h-full w-full relative p-4",children:[e(F,{exitBeforeEnter:!0,children:e(S.div,{className:"home absolute top-0 left-0 -z-10",style:{transformOrigin:"top"},variants:l,initial:{scaleY:0},animate:a?"login":"register",transition:{type:"tween",stiffness:100,duration:.5}},a)}),e(S.div,{className:"home",initial:{opacity:0,delay:1},animate:{opacity:1},exit:{opacity:0},transition:{type:"Inertia",stiffness:100,duration:.75},children:a?e(U,{handleTransition:n}):e(H,{handleTransition:n})},a)]})}function J(a){const[r,l]=f.exports.useState([]),[n,t]=f.exports.useState(!1),[i,m]=f.exports.useState(!1);f.exports.useEffect(()=>{m(!0);async function o(){if(!a.user)return console.log(a);await v.get(`/posts/getAll/${a.user.id}`).then(s=>{l(s.data)}).catch(s=>{console.log(s)}).finally(()=>{m(!1)})}return o(),()=>m(!1)},[n]);const g=r.length!=0?r.map((o,s)=>e(k,{post:o,myposts:!0,setRemovePost:t},s)):e("p",{className:"my-4",children:"Nothing found."});return c("div",{className:"page",children:[e(w,{user:a.user}),c("div",{className:"container",children:[c("div",{className:"flex justify-between items-center   pageTitle",children:[e("h2",{children:"My Posts"}),e(p,{to:"/newPost",className:"p-1 text-green-500 border border-green-500 transition-all hover:bg-green-500 hover:text-white",children:"New Post"})]}),i?e("div",{className:"flex justify-center",children:c("div",{className:"lds-roller invert",children:[e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{})]})}):r&&g]}),e(b,{})]})}function W(a){const r=x(),[l,n]=f.exports.useState({title:"",content:"",author:a.user.id}),[t,i]=f.exports.useState({title:!1,content:!1,isDuplicate:!1,err:!1,isLoading:!1,success:!1});function m(o){i({title:!1,content:!1,isDuplicate:!1,err:!1,isLoading:!1});let{name:s,value:h}=o.target;n(y=>u(d({},y),{[s]:h}))}function g(o){if(o.preventDefault(),l.title=="")return i(s=>u(d({},s),{title:!0}));if(i(s=>u(d({},s),{title:!1})),l.content=="")return i(s=>u(d({},s),{content:!0}));i(s=>u(d({},s),{content:!1})),i(s=>u(d({},s),{isLoading:!0,err:!1})),v.post("/posts/register",l).then(s=>{s.data.status===201?(n(h=>u(d({},h),{title:"",content:""})),i(h=>u(d({},h),{isLoading:!1,success:!0})),setTimeout(()=>{r("/myposts")},1e3)):i(h=>u(d({},h),{isLoading:!1,isDuplicate:!0,success:!1}))}).catch(s=>{i(h=>u(d({},h),{isLoading:!1,err:!0,success:!1}))})}return c("div",{className:"page",children:[e(w,{user:a.user}),c("div",{className:"container",children:[e("h2",{className:"pageTitle",children:"New Post"}),c("form",{className:"mt-4",name:"registerPost",id:"registerPost",children:[e("label",{htmlFor:"title",children:"Title:"}),e("input",{className:`${(t.title||t.isDuplicate)&&"border-red-500"}`,type:"text",id:"title",name:"title",value:l.title,onChange:m,required:!0}),e("label",{htmlFor:"content",children:"Content:"}),e("textarea",{className:`${(t.content||t.isDuplicate)&&"border-red-500"}`,id:"content",name:"content",value:l.content,onChange:m,required:!0,cols:"30",rows:"10"}),t.isDuplicate&&e("p",{className:"text-red-500",children:"Duplicate title..."}),t.err&&e("p",{className:"text-red-500",children:"There was an error, please try again later."}),t.isLoading&&e("div",{className:"flex justify-center",children:c("div",{className:"lds-roller invert",children:[e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{})]})}),t.success&&e("p",{className:"text-green-500",children:"Registered successfully!"}),e("button",{className:"btnPost",type:"submit",onClick:g,children:"Submit"})]})]}),e(b,{})]})}function _(){const a=JSON.parse(localStorage.getItem("user"))||[""],r=x();return f.exports.useEffect(()=>{if(localStorage.getItem("user")==null)return r("/login")},[window.location.href]),e("div",{className:"App",children:c(T,{children:[e(N,{path:"/",element:e(B,{user:a[0]})}),e(N,{path:"/myposts",element:e(J,{user:a[0]})}),e(N,{path:"/newPost",element:e(W,{user:a[0]})}),e(N,{path:"/login",element:e(Y,{})}),e(N,{path:"*",element:e(j,{to:"/",replace:!0})})]})})}A.render(e($.StrictMode,{children:e(O,{children:e(_,{})})}),document.getElementById("root"));
